#!/usr/bin/python
from mdv.sec.sekt import SektCommand

import os
import math

class _(SektCommand):

    usage = "%prog [CVE-range] ..."
    descr = "show matching keywords for CVEs"

    def init_parser(self, parser):
        super(_, self).init_parser(parser)
        parser.add_option("-s", "--strict", action="store_true",
                default=False, help="search using exact match")

    def run(self):
        for arg in self.args:
            cvegen = self.tasks.correlate_cves_packages(arg,
                    strict=self.opts.strict)
            for status, args in cvegen:
                if status == "F":
                    print status, args[0], " ".join(args[1])

_().main()

# vim:ts=4:sw=4:et
